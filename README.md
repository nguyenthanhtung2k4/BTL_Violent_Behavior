<h1 align="center">Nháº­n diá»‡n hÃ nh vi báº¡o lá»±c trong trÆ°á»ng há»c</h1>

<div align="center">

<p align="center">
  <img src="reluts/logoDaiNam.png" alt="DaiNam University Logo" width="200"/>
  <img src="reluts/LogoAIoTLab.png" alt="AIoTLab Logo" width="170"/>
</p>

[![Made by AIoTLab](https://img.shields.io/badge/Made%20by%20AIoTLab-blue?style=for-the-badge)](https://www.facebook.com/DNUAIoTLab)
[![Fit DNU](https://img.shields.io/badge/Fit%20DNU-green?style=for-the-badge)](https://fitdnu.net/)
[![DaiNam University](https://img.shields.io/badge/DaiNam%20University-red?style=for-the-badge)](https://dainam.edu.vn)

</div>

<h2 align="center">MÃ´ hÃ¬nh phÃ¡t hiá»‡n hÃ nh vi báº¡o lá»±c há»c Ä‘Æ°á»ng sá»­ dá»¥ng
máº¡ng nÆ¡-ron tÃ­ch cháº­p CNN</h2>

<p align="left">
  
Dá»± Ã¡n "Violent_Behavior" táº­p trung vÃ o viá»‡c phÃ¡t hiá»‡n vÃ  phÃ¢n loáº¡i hÃ nh vi báº¡o lá»±c trong video sá»­ dá»¥ng cÃ¡c mÃ´ hÃ¬nh há»c sÃ¢u. Má»¥c tiÃªu lÃ  xÃ¢y dá»±ng má»™t há»‡ thá»‘ng cÃ³ kháº£ nÄƒng nháº­n diá»‡n tá»± Ä‘á»™ng cÃ¡c hÃ nh Ä‘á»™ng báº¡o lá»±c, tá»« Ä‘Ã³ há»— trá»£ trong cÃ¡c á»©ng dá»¥ng giÃ¡m sÃ¡t an ninh, phÃ¢n tÃ­ch ná»™i dung video, vÃ  cÃ¡c lÄ©nh vá»±c liÃªn quan.

</p>

---

## ğŸŒŸ Giá»›i thiá»‡u

- **MÃ´ hÃ¬nh nháº­n diá»‡n** MÃ´ hÃ¬nh sáº½ nháº­n diá»‡n qua thÃ´ng qua video vÃ  tráº£ vá» káº¿t quáº£ ngay bÃªn gÃ³c trÃ¡i mÃ n hÃ¬nh.
- **ğŸ’¡ ThÃ´ng bÃ¡o:** Khi nháº­n dáº¡ng Ä‘Æ°á»£c náº¿u mÃ´ hÃ¬nh nháº­n dáº¡nh Ä‘Æ°á»£c Ä‘Ã³ lÃ  hÃ nh vi báº¡o lá»±c trÃªn 75% sáº½ hiá»‡n thÃ´ng bÃ¡o Ä‘Ã³ lÃ  hÃ nh Ä‘á»™ng báº¡o lá»±c.
<!-- - **ğŸ“Š Quáº£n lÃ½ dá»¯ liá»‡u:** Dá»¯ liá»‡u Ä‘iá»ƒm danh Ä‘Æ°á»£c lÆ°u trong MongoDB, cÃ³ thá»ƒ xem lá»‹ch sá»­ vÃ  xuáº¥t ra file CSV.
- **ğŸ–¥ï¸ Giao diá»‡n thÃ¢n thiá»‡n:** Sá»­ dá»¥ng Tkinter cho giao diá»‡n quáº£n lÃ½ vÃ  Flask cho xá»­ lÃ½ Ä‘iá»ƒm danh qua web. -->
<!-- 
---
## ğŸ—ï¸ Há»† THá»NG
<p align="center">
  <img src="images/Quytrinhdiemdanh.png" alt="System Architecture" width="800"/>
</p> -->
### ğŸ“½ï¸ Video giá»›i thiá»‡u


[![VideoVideo](reluts/video.png)](https://drive.google.com/file/d/1HvBPPRdxFYG13r6tVnW1RFvl2_G_gxUs/view?usp=sharing)

## ğŸ‘¨â€ğŸ« ThÃ nh viÃªn:

| MSV        | Há» vÃ  tÃªn           | TÃªn trÆ°á»ng           |
| :--------- | :------------------ | :------------------- |
| 1771020729 | Nguyá»…n Thanh TÃ¹ng   | Dai Nam University  |
| 1771020771 | LÃª VÄƒn VÆ°á»£ng        | Dai Nam University  |
| 1771020650 | Nguyá»…n Quang Thá»‹nh | Dai Nam University  |
<br>
---

## ğŸ“‚ Cáº¥u trÃºc dá»± Ã¡n

ğŸ“¦ Project  
â”œâ”€â”€ ğŸ“‚ Data  # ThÆ° má»¥c chá»©a Dá»¯ liá»‡u video<br>
â”‚_____â”œâ”€â”€ ğŸ“‚ Data_Quay [Táº¡i Ä‘Ã¢y](./Data/Data_Quay/)   # ThÆ° má»¥c video quay Ä‘Æ°á»£c Ä‘Ã¡nh giÃ¡ video <br>
â”‚_____â”œâ”€â”€ ğŸ“‚ Data_Test [Táº¡i Ä‘Ã¢y](./Data/Data_Test/)  # ThÆ° má»¥c chá»©a Dá»¯ liá»‡u video Test mÃ´ hÃ¬nh<br>
â”‚_____â”œâ”€â”€ ğŸ“‚ DataSet [Táº¡i Ä‘Ã¢y](./Data/DataSet/)  # ThÆ° má»¥c chá»©a Dá»¯ liá»‡u video huáº¥n luyá»‡n mÃ´ hÃ¬nh<br>
â”œâ”€â”€ ğŸ“‚ Models  # ThÆ° má»¥c chá»©a mÃ´ hÃ¬nh Ä‘Ã£ Ä‘Æ°á»£c huáº¥n luyá»‡n xong<br>
â”œâ”€â”€ ğŸ“‚ results  # ThÆ° má»¥c chá»©a thÃ´ng tin liÃªn quan phá»¥c vá»¥ cho  README  <br>
â”œâ”€â”€ ğŸ“‚ Train  # ThÆ° má»¥c code huáº¥n luyá»‡n mÃ´ hÃ¬nh<br>
â”‚_____â”œâ”€â”€ ğŸ“„ [Train2D_CNN.py](./Train/Train2D_CNN.py)   # File chá»©a mÃ£ nguá»“n huáº¥n luyá»‡n CNN 2D<br>
â”‚_____â”œâ”€â”€ ğŸ“„ [Train3D_CNN.py](./Train/Train2D_CNN.py)   # File chá»©a code huáº¥n luyá»‡n mÃ´ hÃ¬nh CNN 3D<br>
â”‚_____â”œâ”€â”€ ğŸ“„ [Train3D_CNN_version.py](./Train/Train2D_CNN.py)   # File chá»©a code CNN 3D Ä‘Ã£ Ä‘Æ°á»£c cáº£i tiáº¿n hÆ¡n <br>
â”‚_____â”œâ”€â”€ ğŸ“„ [Train3D_CNN_version.py](./Train/Train2D_CNN.py)   # File chá»©a code CNN 3D Ä‘Ã£ Ä‘Æ°á»£c cáº£i tiáº¿n hÆ¡n <br>
â”œâ”€â”€ ğŸ“‚ Use  # ThÆ° má»¥c chá»©a Code sá»­ dá»¥ng models sau khi train xong<br>
â”‚_____â”œâ”€â”€ ğŸ“„ [[2D_CNN_liveVideo_SaveVideo.py](Use/2D_CNN_liveVideo_SaveVideo.py)]   # File chá»©a mÃ£ code sá»­ dá»¥ng model Cnn 2D - Trong video + LÆ°u káº¿t quáº£ video Trong [Follder](./xuat/)<br>
â”‚_____â”œâ”€â”€ ğŸ“„ [[Use/2D_CNN_liveVideo.py](Use/2D_CNN_liveVideo.py)]   # File chá»©a mÃ£ code sá»­ dá»¥ng model CNN 2D- Trong video <br>
â”‚_____â”œâ”€â”€ ğŸ“„ [[Use/V1_Save_video_3D_CNN.py](Use/V1_Save_video_3D_CNN.py)]   # File chá»©a mÃ£ code sá»­ dá»¥ng model CNN 3D - Trong Video + LÆ°u káº¿t quáº£  [Follder](./xuat/) <br>
â”‚_____â”œâ”€â”€ ğŸ“„ [[Use/V1Camera.py](Use/V1Camera.py)]   # File chá»©a mÃ£ code sá»­ dá»¥ng model CNN 3D - Trong **Camera** trá»±c tiáº¿p  <br>
â”‚_____â”œâ”€â”€ ğŸ“„ [[Use/V1Frame.py](Use/V1Frame.py)]   # File chá»©a mÃ£ code sá»­ dá»¥ng model CNN 3D - Trong tá»«ng khung hÃ¬nh  <br>
â”‚_____â”œâ”€â”€ ğŸ“„ [[Use/V3_Live_Save_Video_3D_CNN.py](Use/V3_Live_Save_Video_3D_CNN.py)]   # File chá»©a mÃ£ code sá»­ dá»¥ng model CNN 3D - Trong video +  [Follder](./xuat/)  <br>
â”‚_____â”œâ”€â”€ ğŸ“„ [[Use/V3_Live_Save_Video_Frame_3D_CNN.py](Use/V3_Live_Save_Video_Frame_3D_CNN.py)]   # File chá»©a mÃ£ code sá»­ dá»¥ng model CNN 3D - Trong video + LÆ°u video + khung hÃ¬nh trong  [Follder](./xuat/) <br>
â”œâ”€â”€ ğŸ“‚ xuat  # ThÆ° má»¥c chá»©a Dá»¯ liá»‡u video<br>
â”œâ”€â”€ ğŸ“„ [[requiment.txt](requiment.txt)]  # File Setup cÃ¡c thÆ° viÃªn<br>
â”œâ”€â”€ ğŸ“„ [[.gitignore](.gitignore)]  # File chá»©a thÃ´ng tin file khÃ´ng muá»‘n Ä‘áº©y lÃªn git<br>




## ğŸ› ï¸ CÃ”NG NGHá»† Sá»¬ Dá»¤NG

<div align="center">
<!-- 
### ğŸ“¡ Pháº§n cá»©ng
[![Arduino](https://img.shields.io/badge/Arduino-00979D?style=for-the-badge&logo=arduino&logoColor=white)](https://www.arduino.cc/)
[![LED](https://img.shields.io/badge/LED-green?style=for-the-badge)]()
[![Buzzer](https://img.shields.io/badge/Buzzer-red?style=for-the-badge)]()
[![WiFi](https://img.shields.io/badge/WiFi-2.4GHz-orange?style=for-the-badge)]() -->

### ğŸ–¥ï¸ Pháº§n má»m
[![Python](https://img.shields.io/badge/Python-3.x-blue?style=for-the-badge&logo=python)]()

[![Tensorflow](https://img.shields.io/badge/Tensorflow-blue)]()
[![OpenCV](https://img.shields.io/badge/OpenCV-blue)]()

</div>

## ğŸ› ï¸ YÃªu cáº§u há»‡ thá»‘ng

<!-- ### ğŸ”Œ Pháº§n cá»©ng
- **Arduino Uno** (hoáº·c board tÆ°Æ¡ng thÃ­ch) vá»›i **LED (2 mÃ u) vÃ  cÃ²i**.
- **CÃ¡p USB** Ä‘á»ƒ káº¿t ná»‘i Arduino vá»›i mÃ¡y tÃ­nh.
- âš ï¸ **LÆ°u Ã½:** Máº·c Ä‘á»‹nh mÃ£ nguá»“n Arduino trong `ThongBao.ino` sá»­ dá»¥ng cá»•ng `COM5`. Náº¿u Arduino cá»§a báº¡n sá»­ dá»¥ng cá»•ng khÃ¡c, hÃ£y thay Ä‘á»•i biáº¿n `SERIAL_PORT` trong `chuongTrinh.py`. -->

### ğŸ’» Pháº§n má»m
- **ğŸ Python 3+**
- **âš¡ Model** YÃªu cáº§u pháº£i cÃ³ models Ä‘Ã£ huáº¥n luyá»‡n rá»“i má»›i cÃ³ thá»ƒ dÃ¹ng Ä‘Æ°á»£c.

### ğŸ“¦ CÃ¡c thÆ° viá»‡n Python cáº§n thiáº¿t
CÃ i Ä‘áº·t mÃ´i trÆ°á»ng áº£o vÃ  cÃ¡c thÆ° viá»‡n báº±ng lá»‡nh:

#### MÃ´i trÆ°á»ng áº£o:

-BÆ°á»›c 1:Tao mÃ´i trÆ°á»ng áº£o + tÃªn mÃ´i trÆ°á»ng
```bash
python -m venv env_violent
```
-BÆ°á»›c 2:Truy váº­p MÃ´i trÆ°á»ng
```bash
cd env_violent/Scripts
```
-BÆ°á»›c 3: KÃ­ch hoáº¡t  mÃ´i trÆ°á»ng
```bash
activate.bat
```
-Náº¿u báº¡n muá»‘n táº¯t mÃ´i trÆ°á»ng áº£o:
```bash
deactivate.bat 
```

>  CÃ i Ä‘áº·t  thÆ°  viÃªn  cáº§n thiáº¿t 
#### CÃ i thÆ° viá»‡n (pip)
```bash
pip install -r requiment.txt
``` 
## ğŸ“£ DOWNLOAD| DataSet 
>  CÃ³ hai loáº¡i  DataSet mÃ  chÃºng tÃ´i Ä‘Ã£ train vá»›i models:
- `Data1`: Äáº¡i diá»‡n cho dataset `'Hockey Fight Vidoes'`:
  - Download vá» mÃ¡y: [Táº¡i Ä‘Ã¢y](./Data/DataSet/Download_Data1.py) 
  - Link Download kaggle: [Táº¡i Ä‘Ã¢y](https://www.kaggle.com/datasets/yassershrief/hockey-fight-vidoes/code)

- `Data2` Äáº¡i diá»‡n cho dataset mÃ  chÃºng tÃ´i sÆ°u táº§m Ä‘Æ°á»£c:
  - Download: [Táº¡i Ä‘Ã¢y](https://drive.google.com/file/d/1tWyFvSRmyhA_lbGTYzqlWT3_Ctl76Zue/view?usp=sharing)

## ğŸš€ HÆ°á»›ng dáº«n cÃ i Ä‘áº·t vÃ  cháº¡y
1ï¸âƒ£ KÃ­ch hoáº¡t mÃ´i trÆ°á»ng áº£o
- Äá»ƒ kÃ­ch hoáº¡t mÃ´i trÆ°á»ng áº£o [Xem táº¡i Ä‘Ã¢y](#-cÃ¡c-thÆ°-viá»‡n-python-cáº§n-thiáº¿t)

2ï¸âƒ£ CÃ i Ä‘áº·t thÆ° viá»‡n Python. 

CÃ i Ä‘áº·t Python 3 náº¿u chÆ°a cÃ³, sau Ä‘Ã³ cÃ i Ä‘áº·t cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t [á» Ä‘Ã¢y](#-cÃ¡c-thÆ°-viá»‡n-python-cáº§n-thiáº¿t)

3ï¸âƒ£  Cháº¡y chÆ°Æ¡ng trÃ¬nh huáº¥n luyá»‡n mÃ´ hÃ¬nh

  Huáº¥n luyá»‡n mÃ´ hÃ¬nh CNN 2D [Táº¡i Ä‘Ã¢y](./Train/) # CÃ¡c file Ä‘Ã£ Ä‘Æ°á»£c giáº£i thÃ­ch kÄ© bÃªn trÃªn

  Huáº¥n luyá»‡n mÃ´ hÃ¬nh CNN 3D [Táº¡i Ä‘Ã¢y](./Train/) # CÃ¡c file Ä‘Ã£ Ä‘Æ°á»£c giáº£i thÃ­ch kÄ© bÃªn trÃªn

  Huáº¥n luyá»‡n mÃ´ hÃ¬nh CNN 3D cáº£i tiáº¿n [Táº¡i Ä‘Ã¢y](./Train/) # CÃ¡c file Ä‘Ã£ Ä‘Æ°á»£c giáº£i thÃ­ch kÄ© bÃªn trÃªn

ğŸ‘‰ LÆ°u Ã½:

 - Dá»¯ liá»‡u huáº¥n luyá»‡n pháº£i náº±m trong thÆ° má»¥c Data/DataSet/

 - Thay Ä‘á»•i cÃ¡c tham sá»‘ huáº¥n luyá»‡n (batch_size, epoch, learning_rate...) trong cÃ¡c file train náº¿u cáº§n thiáº¿t.
 --- 
## ğŸ“Œ CÃ€I Äáº¶T VÃ€ Sá»¬ Dá»¤NG MÃ” HÃŒNH ÄÃƒ HUáº¤N LUYá»†N

1ï¸âƒ£ Cáº¥u trÃºc thÆ° má»¥c quan trá»ng

 - Models/ â Chá»©a cÃ¡c mÃ´ hÃ¬nh Ä‘Ã£ huáº¥n luyá»‡n

 - Use/ â Chá»©a cÃ¡c file Ä‘á»ƒ cháº¡y mÃ´ hÃ¬nh trÃªn video hoáº·c camera

 - xuat/ â ThÆ° má»¥c lÆ°u káº¿t quáº£ video xuáº¥t ra

2ï¸âƒ£ Sá»­ dá»¥ng mÃ´ hÃ¬nh Ä‘Ã£ huáº¥n luyá»‡n

- Cháº¡y mÃ´ hÃ¬nh CNN 2D trÃªn video

- Cháº¡y mÃ´ hÃ¬nh CNN 3D trÃªn video

- Cháº¡y mÃ´ hÃ¬nh CNN 3D trÃªn camera trá»±c tiáº¿p

ğŸ‘‰ LÆ°u Ã½:

 - Kiá»ƒm tra Ä‘Æ°á»ng dáº«n Ä‘áº¿n file mÃ´ hÃ¬nh (Models/) trÆ°á»›c khi cháº¡y.

 - Äáº£m báº£o dá»¯ liá»‡u Ä‘áº§u vÃ o cÃ³ Ä‘á»‹nh dáº¡ng phÃ¹ há»£p.
## ğŸ“– HÆ¯á»šNG DáºªN Sá»¬ Dá»¤NG

### CÃ¡ch 1ï¸âƒ£ CÃ¡ch cháº¡y mÃ´ hÃ¬nh trÃªn video

  -> Äáº·t video cáº§n nháº­n diá»‡n vÃ o thÆ° má»¥c Data/Data_Test [Táº¡i Ä‘Ã¢y](./Data/Data_Test/)

  -> Cháº¡y file python phÃ¹ há»£p vá»›i mÃ´ hÃ¬nh báº¡n muá»‘n sá»­ dá»¥ng

  -> Káº¿t quáº£ sáº½ hiá»ƒn thá»‹ trÃªn mÃ n hÃ¬nh hoáº·c lÆ°u vÃ o thÆ° má»¥c xuat/   [Táº¡i Ä‘Ã¢y](./xuat/)

### CÃ¡ch2ï¸âƒ£ CÃ¡ch cháº¡y mÃ´ hÃ¬nh trÃªn camera trá»±c tiáº¿p

 - Cáº¯m webcam hoáº·c sá»­ dá»¥ng camera laptop

 - Cháº¡y file Use/V1Camera.py [Táº¡i Ä‘Ã¢y](./Use/V1Camera.py)

- - Quan sÃ¡t káº¿t quáº£ hiá»ƒn thá»‹ trÃªn cá»­a sá»• video
## âš™ï¸ Cáº¤U HÃŒNH VÃ€ GHI CHÃš

- **Cáº¥u hÃ¬nh mÃ´ hÃ¬nh**: CÃ³ thá»ƒ Ä‘iá»u chá»‰nh cÃ¡c tham sá»‘ trong cÃ¡c file train.

  - Tham sá»‘ quan trá»ng:

  - img_size = (112, 112) â KÃ­ch thÆ°á»›c áº£nh Ä‘áº§u vÃ o

  - batch_size = 8 (CNN 3D) hoáº·c batch_size = 32 (CNN 2D)

  - frames = 20 â Sá»‘ khung hÃ¬nh má»—i Ä‘oáº¡n video

- **Ghi chÃº:**

  - MÃ´ hÃ¬nh CNN 3D cÃ³ Ä‘á»™ chÃ­nh xÃ¡c cao hÆ¡n (97.67%) so vá»›i CNN 2D (78.63%)

  - MÃ´ hÃ¬nh cÃ³ thá»ƒ má»Ÿ rá»™ng Ä‘á»ƒ nháº­n diá»‡n cÃ¡c hÃ nh vi khÃ¡c báº±ng cÃ¡ch huáº¥n luyá»‡n vá»›i dataset má»›i.


## ÄÃ¡nh giÃ¡ & Káº¿t quáº£:
### ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh
---
| Chá»‰ sá»‘|  3D CNN | 2D CNN|
|-----------------|----------------|----------------|
|Accuracy |97.67% |78.63%|
|Loss| ~ 12% | ~ 40%| 
| val_accuracy | 96 % | ~70.39%|
|Size models|97,667 KB| 129,695|
|frame| 20 |20|
|img_size| 112x112|112x112|
|bath|8|32|


- Káº¿t quáº£ huáº¥n luyá»‡n mÃ´ hÃ¬nh 3D CNN
![img](./reluts/image3D.png)
### Káº¿t quáº£

---
![img](./reluts/imageRealTest3D.png)
- Káº¿t quáº£ cá»§a mÃ´ hÃ¬nh 3D CNN ( Video khÃ´ng chá»©a báº¡o lá»±c)


### ğŸ“º Káº¿t quáº£ Video 

---

ğŸ‘‰ğŸ‘‰ [![Nháº¥p VÃ o Ä‘á»ƒ xem Káº¿t quáº£](./reluts/ketqua.png)](https://drive.google.com/drive/folders/1OQdB40zJs_RCZeEW87eFsBYohA04_Ubx?usp=sharing) ğŸ‘ˆğŸ‘ˆ
- Nháº¥p vÃ o ğŸ‘† xem káº¿t quáº£
---

## ğŸ¤ ÄÃ³ng gÃ³p
Dá»± Ã¡n Ä‘Æ°á»£c phÃ¡t triá»ƒn bá»Ÿi 3 thÃ nh viÃªn:

| Há» vÃ  TÃªn       | Vai trÃ²                  |
|-----------------|--------------------------|
| Nguyá»…n Thanh TÃ¹ng | PhÃ¡t triá»ƒn toÃ n bá»™ mÃ£ nguá»“n , há»— trá»£ tÃ i bÃ i bÃ¡o cÃ¡o|
| LÃª VÄƒn VÆ°á»£ng |Thiáº¿t káº¿ slide PowerPoint, há»— trá»£ bÃ i táº­p lá»›n, thuyáº¿t trÃ¬nh, tÃ¬m kiáº¿m dataset|
| Nguyá»…n Quang Thá»‹nh   | BiÃªn soáº¡n tÃ i liá»‡u Overleaf,Thiáº¿t káº¿ slide PowerPoint|

Â© 2025 NHÃ“M 9, CNTT17-15, TRÆ¯á»œNG Äáº I Há»ŒC Äáº I NAM





